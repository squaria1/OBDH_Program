<?xml version="1.0" encoding="UTF-8"?>
<!--

    Copyright 2022 bitValence, Inc.
    All Rights Reserved.

    This program is free software; you can modify and/or redistribute it
    under the terms of the GNU Affero General Public License
    as published by the Free Software Foundation; version 3 with
    attribution addendums as found in the LICENSE.txt.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU Affero General Public License for more details.
      
    Purpose: 
      Define HI_WORLD application interfaces 

    Notes:
      1. This file was automatically generated by cFS Basecamp's app
         creation tool. If you edit it, your changes will be lost if
         a new app with the same name is created. 
      2. This document adheres to the Electronic Data Sheet (EDS) XML schema 
         as prescribed in CCSDS book 876.0. 
      
-->
<PackageFile xmlns="http://www.ccsds.org/schema/sois/seds">
  <Package name="HI_WORLD" shortDescription="Auto-generated Hello World app">
      <DataTypeSet>

      <!--***********************************-->
      <!--**** DataTypeSet:  Entry Types ****-->
      <!--***********************************-->


      <!--***************************************-->
      <!--**** DataTypeSet: Command Payloads ****-->
      <!--***************************************-->
      
<!--
      <EnumeratedDataType name="SetParam_CmdPayload" shortDescription="Change the OBDH main state of the state machine" >
        <IntegerDataEncoding sizeInBits="16" encoding="unsigned" />
        <EnumerationList>
          <Enumeration label="SafeMode"  value="0x0701" shortDescription="" />
          <Enumeration label="ControlMode" value="0x0702" shortDescription="" />
          <Enumeration label="Regulate"  value="0x0703" shortDescription="" />
          <Enumeration label="Restart"  value="0x07FF" shortDescription="" />
        </EnumerationList>
      </EnumeratedDataType>
-->

      <EnumeratedDataType name="SetParam_Mode" shortDescription="Change the OBDH main state of the state machine">
        <IntegerDataEncoding sizeInBits="16" encoding="unsigned" />
        <EnumerationList>
          <Enumeration label="SafeMode"  value="0x0701" shortDescription="" />
          <Enumeration label="ControlMode" value="0x0702" shortDescription="" />
          <Enumeration label="Regulate"  value="0x0703" shortDescription="" />
          <Enumeration label="Restart"  value="0x07FF" shortDescription="" />
        </EnumerationList>
      </EnumeratedDataType>

      <ContainerDataType name="SetParam_CmdPayload" shortDescription="Example command payload">
        <EntryList>
          <Entry name="Param" type="SetParam_Mode" shortDescription="" />
        </EntryList>
      </ContainerDataType>

<!--
      <ContainerDataType name="SetParam_CmdPayload" shortDescription="Example command payload">
        <EntryList>
          <Entry name="Param" type="BASE_TYPES/uint16" shortDescription="" />
       </EntryList>
      </ContainerDataType>
-->

      <!--*****************************************-->
      <!--**** DataTypeSet: Telemetry Payloads ****-->
      <!--*****************************************-->
    
      <ContainerDataType name="StatusTlm_Payload" shortDescription="App's state and status summary, Historically known as 'housekeeping data'">
        <EntryList>
          <Entry name="ValidCmdCnt"         type="BASE_TYPES/uint16" />
          <Entry name="InvalidCmdCnt"       type="BASE_TYPES/uint16" />
          <Entry name="SetParamCmdVal"      type="BASE_TYPES/uint16" />
          <Entry name="OBDHStatus"      		type="BASE_TYPES/uint16" />
          <Entry name="OBDHMainState"       type="BASE_TYPES/uint16" />
          <Entry name="OBDHError"      		  type="BASE_TYPES/uint16" />
          <Entry name="PayloadStatus"      	type="BASE_TYPES/uint16" />
          <Entry name="PayloadMainState"    type="BASE_TYPES/uint16" />
          <Entry name="PayloadError"      	type="BASE_TYPES/uint16" />
          <Entry name="EPSStatus"      		  type="BASE_TYPES/uint16" />
          <Entry name="EPSMainState"      	type="BASE_TYPES/uint16" />
          <Entry name="EPSError"      		  type="BASE_TYPES/uint16" />
          <Entry name="sensor1"      		    type="BASE_TYPES/uint8" />
          <Entry name="sensor2"      		    type="BASE_TYPES/uint16" />
          <Entry name="sensor3"      		    type="BASE_TYPES/uint32" />
        </EntryList>
      </ContainerDataType>
      
      <!--**************************************-->
      <!--**** DataTypeSet: Command Packets ****-->
      <!--**************************************-->

      <ContainerDataType name="CommandBase" baseType="CFE_HDR/CommandHeader">
      </ContainerDataType>

      <ContainerDataType name="Noop" baseType="CommandBase" shortDescription="Generate an information event message with app version">
        <ConstraintSet>
          <ValueConstraint entry="Sec.FunctionCode" value="${APP_C_FW/NOOP_CC}" />
        </ConstraintSet>
      </ContainerDataType>

      <ContainerDataType name="Reset" baseType="CommandBase" shortDescription="Reset app to a known state">
        <ConstraintSet>
          <ValueConstraint entry="Sec.FunctionCode" value="${APP_C_FW/RESET_CC}" />
        </ConstraintSet>
      </ContainerDataType>

      <ContainerDataType name="SetParam" baseType="CommandBase" shortDescription="">
        <ConstraintSet>
          <ValueConstraint entry="Sec.FunctionCode" value="${APP_C_FW/APP_BASE_CC} + 0" />
        </ConstraintSet>
        <EntryList>
          <Entry type="SetParam_CmdPayload" name="Payload" />
        </EntryList>
      </ContainerDataType>


      <!--****************************************-->
      <!--**** DataTypeSet: Telemetry Packets ****-->
      <!--****************************************-->

      <ContainerDataType name="StatusTlm" baseType="CFE_HDR/TelemetryHeader">
        <EntryList>
          <Entry type="StatusTlm_Payload" name="Payload" />
        </EntryList>
      </ContainerDataType>
      
      <!--
      <ContainerDataType name="changeOBDHMainStateCmd" baseType="CFE_HDR/TelemetryHeader">
        <EntryList>
          <Entry type="changeOBDHMainStateCmd" name="Payload" />
        </EntryList>
      </ContainerDataType>
      -->

    </DataTypeSet>
    
    <ComponentSet>
      <Component name="Application">

        <!--***********************************-->
        <!--**** Component Set: Interfaces ****-->
        <!--***********************************-->

        <RequiredInterfaceSet>

          <Interface name="CMD" shortDescription="Software bus telecommand interface" type="CFE_SB/Telecommand">
            <GenericTypeMapSet>
              <GenericTypeMap name="TelecommandDataType" type="CommandBase" />
            </GenericTypeMapSet>
          </Interface>
          
          <Interface name="STATUS_TLM" shortDescription="Software bus status telemetry interface" type="CFE_SB/Telemetry">
            <GenericTypeMapSet>
              <GenericTypeMap name="TelemetryDataType" type="StatusTlm" />
            </GenericTypeMapSet>
          </Interface>
          
        </RequiredInterfaceSet>

        <!--***************************************-->
        <!--**** Component Set: Implementation ****-->
        <!--***************************************-->

        <Implementation>
          <VariableSet>
            <Variable type="BASE_TYPES/uint16" readOnly="true" name="CmdTopicId" initialValue="${CFE_MISSION/HI_WORLD_CMD_TOPICID}" />
            <Variable type="BASE_TYPES/uint16" readOnly="true" name="StatusTlmTopicId" initialValue="${CFE_MISSION/HI_WORLD_STATUS_TLM_TOPICID}" />
          </VariableSet>
          <!-- Assign fixed numbers to the "TopicId" parameter of each interface -->
          <ParameterMapSet>          
            <ParameterMap interface="CMD" parameter="TopicId" variableRef="CmdTopicId" />
            <ParameterMap interface="STATUS_TLM" parameter="TopicId" variableRef="StatusTlmTopicId" />
          </ParameterMapSet>
        </Implementation>
      </Component>
    </ComponentSet>
    
  </Package>
</PackageFile>
